DROP VIEW IF EXISTS `view_stats_daily`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `view_stats_daily` AS
select `t`.`agrType` AS `agrType`,`t`.`ambient_temp` AS `ambient_temp`,`t`.`ground_temp` AS `ground_temp`,`t`.`pressure` AS `pressure`,`t`.`humidity` AS `humidity`,`t`.`wind_average` AS `wind_average`,`t`.`wind_speed` AS `wind_speed`,`t`.`wind_gust` AS `wind_gust`,`t`.`rainfall` AS `rainfall`,`t`.`date` AS `date`
from
(select 'min' AS `agrType`,min(`measurements`.`ambient_temp`) AS `ambient_temp`,min(`measurements`.`ground_temp`) AS `ground_temp`,min(`measurements`.`pressure`) AS `pressure`,min(`measurements`.`humidity`) AS `humidity`,min(`measurements`.`wind_average`) AS `wind_average`,min(`measurements`.`wind_speed`) AS `wind_speed`,min(`measurements`.`wind_gust`) AS `wind_gust`,sum(`measurements`.`rainfall`) AS `rainfall`,date_format(`measurements`.`created`,'%Y-%m-%d') AS `date` from `measurements` group by date_format(`measurements`.`created`,'%Y-%m-%d') union
select 'max' AS `agrType`,max(`measurements`.`ambient_temp`) AS `ambient_temp`,max(`measurements`.`ground_temp`) AS `ground_temp`,max(`measurements`.`pressure`) AS `pressure`,max(`measurements`.`humidity`) AS `humidity`,max(`measurements`.`wind_average`) AS `wind_average`,max(`measurements`.`wind_speed`) AS `wind_speed`,max(`measurements`.`wind_gust`) AS `wind_gust`,sum(`measurements`.`rainfall`) AS `rainfall`,date_format(`measurements`.`created`,'%Y-%m-%d') AS `date` from `measurements` group by date_format(`measurements`.`created`,'%Y-%m-%d') union
select 'avg' AS `agrType`,avg(`measurements`.`ambient_temp`) AS `ambient_temp`,avg(`measurements`.`ground_temp`) AS `ground_temp`,avg(`measurements`.`pressure`) AS `pressure`,avg(`measurements`.`humidity`) AS `humidity`,avg(`measurements`.`wind_average`) AS `wind_average`,avg(`measurements`.`wind_speed`) AS `wind_speed`,avg(`measurements`.`wind_gust`) AS `wind_gust`,sum(`measurements`.`rainfall`) AS `rainfall`,date_format(`measurements`.`created`,'%Y-%m-%d') AS `date` from `measurements` group by date_format(`measurements`.`created`,'%Y-%m-%d') union
select 'stdv' AS `agrType`,std(`measurements`.`ambient_temp`) AS `ambient_temp`,std(`measurements`.`ground_temp`) AS `ground_temp`,std(`measurements`.`pressure`) AS `pressure`,std(`measurements`.`humidity`) AS `humidity`,std(`measurements`.`wind_average`) AS `wind_average`,std(`measurements`.`wind_speed`) AS `wind_speed`,std(`measurements`.`wind_gust`) AS `wind_gust`,sum(`measurements`.`rainfall`) AS `rainfall`,date_format(`measurements`.`created`,'%Y-%m-%d') AS `date` from `measurements` group by date_format(`measurements`.`created`,'%Y-%m-%d')) `t`;